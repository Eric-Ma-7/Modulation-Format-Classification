# CNN MFI

The codes in [this folder]( https://github.com/Eric-Ma-7/Modulation-Format-Classification/tree/master/src/CNN) give a realization of modulation format identification(MFI) using convolutional neural networks(CNN)

## Code Explanation
### Dataset Generation

[`cnn_dataset_generation.m`]( https://github.com/Eric-Ma-7/Modulation-Format-Classification/blob/master/src/CNN/cnn_dataset_generation.m) can generate a dataset with different digital modulation formats, including the following modulation formats:

| modulation | bit per symbol | class |
|:---:|:---:|:---:|
| 2PSK | 1 | PSK |
| 8PSK | 3 | PSK |
| 16PSK | 4 | PSK |
| QPSK | 2 | QAM |
| 8QAM | 3 | QAM |
| 16QAM | 4 | QAM |
| 32QAM | 5 | QAM |

The dataset generated by `cnn_dataset_generation.m` contains the **constellation diagrams** of different digital modulation formats with size **454x454**. All the images are stored in the directory `imageDataFolder` (`\dataset_cnn_train` by default)

### CNN Training

[`cnn_train.m`](https://github.com/Eric-Ma-7/Modulation-Format-Classification/blob/master/src/CNN/cnn_train.m) uses the dataset saved in `imdsFolder` (`\dataset_cnn_train` by default) to train CNN defined in the script. The dataset will be divided into 2 parts. One part will be the training set and the another will be the validation set.

When training the CNN, there will be a message box to show the progress of training.

After training, the training result is the variable `net` in the workspace and saving the `net` variable is recommended. The script will validating the CNN based on the validation set and display the accuracy of CNN.

### CNN Validation

[`cnn_validation.m`](https://github.com/Eric-Ma-7/Modulation-Format-Classification/blob/master/src/CNN/cnn_validation.m) can validate the CNN based on the randomly generated dataset, contains all formats of modultion under consideration. The validating results are shown in the **heatmap**, where the row labels are the predicted formats.

